<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `log` mod in crate `tbd`.">
    <meta name="keywords" content="rust, rustlang, rust-lang, log">

    <title>tbd::log - Rust</title>

    <link rel="stylesheet" type="text/css" href="../../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../../main.css">

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'><a href='../index.html'>tbd</a></p><script>window.sidebarCurrent = {name: 'log', ty: 'mod', relpath: '../'};</script><script defer src="../sidebar-items.js"></script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content mod">
<h1 class='fqn'><span class='in-band'>Module <a href='../index.html'>tbd</a>::<wbr><a class='mod' href=''>log</a></span><span class='out-of-band'><span id='render-detail'>
            <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                [<span class='inner'>&#x2212;</span>]
            </a>
        </span><a id='src-173' class='srclink' href='../../src/tbd/src/log.rs.html#1-386' title='goto source code'>[src]</a></span></h1>
<div class='docblock'><p>Log entries chained by crypto hashes.</p>

<h1 id='usage' class='section-header'><a href='#usage'>Usage</a></h1>
<p>As the most abstract type, the main type is the Log trait in
this module.  It has a basic implementation DefaultLog which
implements all of its features (of course) and additionally
provides the ability to define custom load and save closures
which can be used to save and load entries.  By default, they
are empty.</p>

<p>Since all entries are chained by their crypto hashes, the
Hashable trait must be implemented for the types.  It&#39;s also
possible to implement the Writable trait which provides a
a helper function to calculate the hash.</p>

<h1 id='examples' class='section-header'><a href='#examples'>Examples</a></h1>
<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>tbd</span>::<span class='ident'>log</span>::<span class='op'>*</span>;
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>io</span>::<span class='ident'>Write</span>;

<span class='comment'>// Defining the type we want to store.  Lets use a simple struct which</span>
<span class='comment'>// stores a byte for this example.</span>
<span class='kw'>struct</span> <span class='ident'>MyStruct</span> {
   <span class='ident'>x</span>: <span class='ident'>u8</span>
}

<span class='comment'>// Implement the Writable trait.  We need it for two reasons:</span>
<span class='comment'>// 1. For serialization to save it.</span>
<span class='comment'>// 2. To generate a hash value.</span>
<span class='kw'>impl</span> <span class='ident'>Writable</span> <span class='kw'>for</span> <span class='ident'>MyStruct</span> {
   <span class='kw'>fn</span> <span class='ident'>write_to</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>, <span class='ident'>write</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>Write</span>) {
      <span class='kw'>let</span> <span class='ident'>byte</span> <span class='op'>=</span> [<span class='self'>self</span>.<span class='ident'>x</span>];
      <span class='ident'>write</span>.<span class='ident'>write</span>(<span class='kw-2'>&amp;</span><span class='ident'>byte</span>);
   }
}

<span class='comment'>// Make our type Hashable so we can store it in the Log.</span>
<span class='comment'>// Use the helper function writeable_to_hash to implement as_hash()</span>
<span class='kw'>impl</span> <span class='ident'>Hashable</span> <span class='kw'>for</span> <span class='ident'>MyStruct</span> {
   <span class='kw'>fn</span> <span class='ident'>as_hash</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>Hash</span> {
      <span class='self'>self</span>.<span class='ident'>writeable_to_hash</span>()
   }
}

<span class='comment'>// Create new log object.  DefaultLog is the standard implementation</span>
<span class='comment'>// which also provides support to store and load entries and for iterators.</span>
<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>log</span>: <span class='ident'>DefaultLog</span><span class='op'>&lt;</span><span class='ident'>MyStruct</span><span class='op'>&gt;</span> <span class='op'>=</span> <span class='ident'>DefaultLog</span>::<span class='ident'>new</span>();

<span class='comment'>// Add some entries</span>
<span class='kw'>let</span> <span class='ident'>first_hash</span>: <span class='ident'>Hash</span> <span class='op'>=</span> <span class='ident'>log</span>.<span class='ident'>push</span>(<span class='ident'>MyStruct</span>{<span class='ident'>x</span>: <span class='number'>42</span>});
<span class='kw'>let</span> <span class='ident'>second_hash</span>: <span class='ident'>Hash</span> <span class='op'>=</span> <span class='ident'>log</span>.<span class='ident'>push</span>(<span class='ident'>MyStruct</span>{<span class='ident'>x</span>: <span class='number'>23</span>});

<span class='comment'>// The push method returns the hash value which can be used as key.</span>
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='string'>&quot;377194384a7432ebd8d8e0f19a1bcc17f115a220d48e280f8d75b6a5b43c3e1d&quot;</span>,
               <span class='kw-2'>&amp;</span><span class='ident'>first_hash</span>.<span class='ident'>as_string</span>());
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='string'>&quot;5894a38091d60a64cb6396edc2662c6460c3685b78b4381051dbc15ff30c5bcc&quot;</span>,
               <span class='kw-2'>&amp;</span><span class='ident'>second_hash</span>.<span class='ident'>as_string</span>());

<span class='comment'>// Inserting the same value again gives a completely different hash because</span>
<span class='comment'>// the hash also contains the previous entry.</span>
<span class='kw'>let</span> <span class='ident'>third_hash</span>: <span class='ident'>Hash</span> <span class='op'>=</span> <span class='ident'>log</span>.<span class='ident'>push</span>(<span class='ident'>MyStruct</span>{<span class='ident'>x</span>: <span class='number'>23</span>});
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='string'>&quot;f87fa51292d72bb55a842b3f46c83adf71720a89abc3c7d89494d84458b57861&quot;</span>,
               <span class='kw-2'>&amp;</span><span class='ident'>third_hash</span>.<span class='ident'>as_string</span>());

<span class='comment'>// With get, we can borrow the entries using the hashes received from the</span>
<span class='comment'>// push method.</span>
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='number'>42</span>, <span class='ident'>log</span>.<span class='ident'>get</span>(<span class='ident'>first_hash</span>).<span class='ident'>unwrap</span>().<span class='ident'>x</span>);
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='number'>23</span>, <span class='ident'>log</span>.<span class='ident'>get</span>(<span class='ident'>second_hash</span>).<span class='ident'>unwrap</span>().<span class='ident'>x</span>);
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='number'>23</span>, <span class='ident'>log</span>.<span class='ident'>get</span>(<span class='ident'>third_hash</span>).<span class='ident'>unwrap</span>().<span class='ident'>x</span>);

<span class='comment'>// Iterate over the entries</span>
<span class='comment'>// This log operates like a stack and will return the last (latest)</span>
<span class='comment'>// entry first.</span>
<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>res</span> <span class='op'>=</span> <span class='ident'>Vec</span>::<span class='op'>&lt;</span><span class='ident'>u8</span><span class='op'>&gt;</span>::<span class='ident'>new</span>();
<span class='kw'>for</span> <span class='ident'>item</span> <span class='kw'>in</span> <span class='ident'>log</span>.<span class='ident'>iter</span>() {
    <span class='ident'>res</span>.<span class='ident'>push</span>(<span class='ident'>item</span>.<span class='ident'>x</span>);
}

<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='number'>23</span>, <span class='ident'>res</span>[<span class='number'>0</span>]);
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='number'>23</span>, <span class='ident'>res</span>[<span class='number'>1</span>]);
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='number'>42</span>, <span class='ident'>res</span>[<span class='number'>2</span>]);

<span class='comment'>// We can also iterate over the hashes.  Lets collect all in a Vec.</span>
<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>hashes</span>: <span class='ident'>Vec</span><span class='op'>&lt;</span><span class='ident'>Hash</span><span class='op'>&gt;</span> <span class='op'>=</span> <span class='ident'>log</span>.<span class='ident'>hash_iter</span>().<span class='ident'>collect</span>();
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='number'>3</span>, <span class='ident'>hashes</span>.<span class='ident'>len</span>());
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='string'>&quot;f87fa51292d72bb55a842b3f46c83adf71720a89abc3c7d89494d84458b57861&quot;</span>,
               <span class='kw-2'>&amp;</span><span class='ident'>hashes</span>[<span class='number'>0</span>].<span class='ident'>as_string</span>());
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='string'>&quot;5894a38091d60a64cb6396edc2662c6460c3685b78b4381051dbc15ff30c5bcc&quot;</span>,
               <span class='kw-2'>&amp;</span><span class='ident'>hashes</span>[<span class='number'>1</span>].<span class='ident'>as_string</span>());
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='string'>&quot;377194384a7432ebd8d8e0f19a1bcc17f115a220d48e280f8d75b6a5b43c3e1d&quot;</span>,
               <span class='kw-2'>&amp;</span><span class='ident'>hashes</span>[<span class='number'>2</span>].<span class='ident'>as_string</span>());
 </pre>
</div><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.DefaultLog.html'
                               title='tbd::log::DefaultLog'>DefaultLog</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.DefaultLogEntry.html'
                               title='tbd::log::DefaultLogEntry'>DefaultLogEntry</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.LogIteratorHash.html'
                               title='tbd::log::LogIteratorHash'>LogIteratorHash</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.LogIteratorRef.html'
                               title='tbd::log::LogIteratorRef'>LogIteratorRef</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                </table><h2 id='enums' class='section-header'><a href="#enums">Enums</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='enum' href='enum.Hash.html'
                               title='tbd::log::Hash'>Hash</a></td>
                        <td class='docblock short'>
                             <p>Stores one of the supported hash values.</p>
                        </td>
                    </tr>
                </table><h2 id='traits' class='section-header'><a href="#traits">Traits</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.Hashable.html'
                               title='tbd::log::Hashable'>Hashable</a></td>
                        <td class='docblock short'>
                             <p>Can generate a hash type which represents the current type.</p>
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.Log.html'
                               title='tbd::log::Log'>Log</a></td>
                        <td class='docblock short'>
                             <p>Contains a ordered set of entries and use a way to verify them.</p>
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.Writable.html'
                               title='tbd::log::Writable'>Writable</a></td>
                        <td class='docblock short'>
                             <p>Write itself to any write trait.</p>
                        </td>
                    </tr>
                </table></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../../";
        window.currentCrate = "tbd";
        window.playgroundUrl = "";
    </script>
    <script src="../../jquery.js"></script>
    <script src="../../main.js"></script>
    
    <script defer src="../../search-index.js"></script>
</body>
</html>